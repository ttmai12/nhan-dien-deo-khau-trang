<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Há»‡ thá»‘ng Camera GiÃ¡m sÃ¡t Äeo Kháº©u trang</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <div class="container">
        <div class="header animate-header">
            <h1>ğŸ¥ Há»‡ thá»‘ng Camera GiÃ¡m sÃ¡t Äeo Kháº©u trang</h1>
            <p>AI-Powered Mask Detection System - Real-time Monitoring</p>
        </div>
        <div class="actions" style="display: flex; justify-content: space-between; align-items: center; gap: 32px; margin-bottom: 24px; margin-top: 32px;">
            <a href="/login" class="btn" style="min-width:120px; text-align:center; font-weight:bold; border-radius:8px; border:1px solid #bdbdbd; background:#fff; color:#333; box-shadow:0 2px 8px #e0e0e0; text-decoration:none;">ÄÄƒng nháº­p</a>
            <a href="/register" class="btn" style="min-width:120px; text-align:center; font-weight:bold; border-radius:8px; border:1px solid #bdbdbd; background:#fff; color:#333; box-shadow:0 2px 8px #e0e0e0; text-decoration:none;">ÄÄƒng kÃ½</a>
            <a href="/logout" class="btn" style="min-width:120px; text-align:center; font-weight:bold; border-radius:8px; border:1px solid #bdbdbd; background:#fff; color:#333; box-shadow:0 2px 8px #e0e0e0; text-decoration:none;">ÄÄƒng xuáº¥t</a>
            <a href="/admin" class="btn" style="min-width:160px; text-align:center; font-weight:bold; border-radius:8px; border:1px solid #bdbdbd; background:#fff; color:#333; box-shadow:0 2px 8px #e0e0e0; text-decoration:none;">Quáº£n trá»‹ & Xuáº¥t/XÃ³a bÃ¡o cÃ¡o</a>
        </div>
        <div class="main-content" style="display: flex; gap: 32px; justify-content: center; align-items: flex-start;">
            <div class="camera-section" style="flex:1; min-width:320px;">
                <div class="status-indicator status-inactive" id="statusIndicator"></div>
                <h3 style="margin-bottom: 15px; color: #333;">ğŸ“¹ Camera GiÃ¡m sÃ¡t</h3>
                <div class="camera-container" id="cameraContainer">
                    <video id="cameraVideo" style="width: 100%; height: 100%; object-fit: cover; display: none; border-radius: 12px;"></video>
                    <canvas id="cameraCanvas" style="width: 100%; height: 100%; object-fit: cover; display: none; border-radius: 12px;"></canvas>
                    <div class="camera-placeholder" id="cameraPlaceholder">
                        <div style="font-size: 3em; margin-bottom: 15px;">ğŸ“·</div>
                        <div>Nháº¥n "Báº­t Camera GiÃ¡m sÃ¡t" Ä‘á»ƒ khá»Ÿi Ä‘á»™ng camera</div>
                        <div style="font-size: 0.9em; margin-top: 10px; opacity: 0.8;">Camera sáº½ yÃªu cáº§u quyá»n truy cáº­p</div>
                    </div>
                    <div class="detection-overlay" id="detectionOverlay"></div>
                </div>
                <div style="margin-bottom:12px;">
                    <label for="cameraSelect" style="font-weight:bold; color:#7e57c2; font-size:1.1em; margin-bottom:8px; display:block;">Chá»n camera giÃ¡m sÃ¡t:</label>
                    <select id="cameraSelect" style="padding:8px; border-radius:8px; min-width:180px;"></select>
                </div>
                <div class="controls">
                    <button class="btn btn-primary" onclick="startCamera()">ğŸš€ Báº­t Camera GiÃ¡m sÃ¡t</button>
                    <button class="btn btn-primary" onclick="startMonitoring()" id="monitorBtn" style="display: none;">ğŸ¯ Báº¯t Ä‘áº§u GiÃ¡m sÃ¡t</button>
                    <button class="btn btn-danger" onclick="stopMonitoring()">â¹ï¸ Dá»«ng GiÃ¡m sÃ¡t</button>
                    <button class="btn" id="captureBtn" onclick="capturePhoto()" style="display:inline-block;">ğŸ“¸ Chá»¥p áº£nh</button>
                </div>
                <div style="margin-top:18px;">
                    <label for="fileUpload" style="font-weight:bold; color:#7e57c2; font-size:1.1em; margin-bottom:8px; display:block;">Táº£i áº£nh tá»« mÃ¡y lÃªn Ä‘á»ƒ phÃ¢n tÃ­ch:</label>
                    <input id="fileUpload" type="file" accept="image/*" onchange="handleUpload(event)">
                    <img id="uploadPreview" style="display:none; margin-top:10px; box-shadow:0 2px 8px #b39ddb; border:2px solid #7e57c2; border-radius:12px;" />
                </div>
            </div>
            <div class="stats-panel animate-panel" style="flex:1; min-width:320px;">
                <h3>ğŸ“Š Thá»‘ng kÃª Realtime</h3>
                <div class="stat-item">
                    <div class="stat-label">Tá»•ng sá»‘ ngÆ°á»i phÃ¡t hiá»‡n</div>
                    <div class="stat-value" id="totalPeople">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">âœ… Äeo kháº©u trang Ä‘Ãºng</div>
                    <div class="stat-value success" id="maskCount">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">âš ï¸ Äeo kháº©u trang sai</div>
                    <div class="stat-value warning" id="incorrectMaskCount">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">âŒ KhÃ´ng Ä‘eo kháº©u trang</div>
                    <div class="stat-value danger" id="noMaskCount">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">ğŸ“ˆ Tá»· lá»‡ tuÃ¢n thá»§</div>
                    <div class="stat-value" id="complianceRate">0%</div>
                </div>
                <div class="alerts-section">
                    <h4 style="margin-bottom: 15px; color: #333;">ğŸš¨ Cáº£nh bÃ¡o gáº§n Ä‘Ã¢y</h4>
                    <div id="alertsList">
                        <div class="alert-item">
                            <div>Há»‡ thá»‘ng Ä‘ang chá» kÃ­ch hoáº¡t...</div>
                            <div class="alert-time">Sáºµn sÃ ng giÃ¡m sÃ¡t</div>
                        </div>
                    </div>
                </div>
                <div id="sessionStats" style="margin-top:18px;"></div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/face-api.js"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
